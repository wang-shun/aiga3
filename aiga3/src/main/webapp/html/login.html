<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>登录系统</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- 收藏用图标 -->
    <link rel="bookmark"  type="image/x-icon"  href="style/images/favicon.ico"/>
    <!-- 标签页图标 -->
    <link rel="shortcut icon" href="style/images/favicon.ico">
    <link rel="stylesheet" href="lib/font-awesome/4.7.0/css/font-awesome.css">
    <link rel="stylesheet" href="lib/xsm-msgbox/0.2.0/css/xsm-msgbox.css">
    <link rel="stylesheet" href="style/login.css">
</head>
<body >
<div id="login" id="Page_loginSignIn">
    <div class="wrapper">
        <div style="margin-left:40px;margin-top:20px">
            <!-- Logo -->
            <a href="index.html" class="logo">
            	<img src="style/images/logo.png" alt="中国移动欢迎您">
            </a>
        </div>
		<div style="float:left;margin-left:11%;margin-top:8%;text-align: center;">
			<div style="font-size:200%;color:#5BABE6;margin-bottom: 10px">分层 · 分域 · 系统巡检</div>
			<div style="font-size:250%;margin-bottom: 10px">让每个系统都有身份证</div>
			<div><img src="style/images/loginWord.png" alt="系统巡检 技术专题  架构指标" style="width: 260px"></div>
		</div>
        <div class="login">
            <div id="myform"  class="container offset1 loginform">
                <div id="owl-login">
                    <div class="hand"></div>
                    <div class="hand hand-r"></div>
                    <div class="arms">
                        <div class="arm"></div>
                        <div class="arm arm-r"></div>
                    </div>
                </div>
                <div class="pad">
                    <input type="hidden" name="_csrf" value="9IAtUxV2CatyxHiK2LxzOsT6wtBE6h8BpzOmk=">
                    <div style="font-size:200%;color:#2c88cc;margin-bottom: 10px;text-align: center;">架构资产管控平台</div>
                    <div class="control-group">
                        <div class="controls">
                            <label for="username" class="control-label fa fa-user"></label>
                            <input  type="text" id="username" name="username" placeholder="请输入用户名" tabindex="1" autofocus="autofocus" class="form-control input-medium">
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="controls">
                            <label for="password" class="control-label fa fa-asterisk"></label>
                            <input  type="password" id="password" name="password" placeholder="请输入密码" tabindex="2" class="form-control input-medium">
                        </div>
                    </div>
                    <div id="tips-error" style="color: red; padding: 5px 3px;"></div>
                </div>
                <div class="form-actions">
                	<a href="#nogo" tabindex="5" id="JS_changePassword" class="btn pull-left btn-link text-muted">修改密码</a>
                	<a href="#nogo" tabindex="6" id="JS_accountSearch" class="btn pull-left btn-link text-muted">账号查询</a>
                	<a href="#nogo" tabindex="7" id="JS_signIn" class="btn btn-link text-muted">注册</a>
                    <button id="mysubmit" type="submit" tabindex="4" class="btn btn-primary">登录系统</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div style="margin-top:13%"><div style="margin-top:120px;height: 30px;background-color: #5FAAE1"></div></div>
<!-- 修改密码 Modal -->
<div class="modal fade" id="JS_changePasswordModal" tabindex="-1" role="dialog" >
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <form id="JS_changePasswordForm">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">修改密码</h4>
                </div>
                <div class="modal-body">
                    <div class="row" >
                        <div class="col-md-12">
                            <div class="form-group input-group-sm">
                                <label>用户名<i class="text-red" style="color:red">*</i></label>
                                <input type="text" class="form-control" name="code" required>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group input-group-sm">
                                <label>原密码<i class="text-red" style="color:red">*</i></label>
                                <input type="password" class="form-control" name="password" required>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group input-group-sm">
                                <label>新密码<i class="text-red" style="color:red">*</i></label>
                                <input type="password" class="form-control" name="newPassword" required>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group input-group-sm">
                                <label>重复密码<i class="text-red" style="color:red">*</i></label>
                                <input type="password" class="form-control" name="recentnewPassword" required>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="text-center">
                        <button type="reset" class="btn btn-default">重置</button>
                        <button type="button" class="btn btn-primary" name="submit">确认</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- 账号查询  -->
<div class="modal fade" id="JS_accountSearchModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <form id="JS_accountSearchForm">
            	<div class="modal-header">
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	                <h4 class="modal-title">账号查询</h4>
	            </div>
	            <div class="modal-body">
                	<div class="row">
                		<div class="col-md-5">
                			<label class="control-label margin-onl">名称:</label>
	     					<input name="name" type="text" class="form-control input-sm"></input>
                		</div>
						<div class="col-md-5">
                			<label class="control-label margin-onl">手机号码:</label>
	     					<input name="billId" type="text" class="form-control input-sm"></input>
                		</div>
                		<button type="button" class="btn btn-primary margin-onl" data-toggle="modal" name="query" style="margin-top: 22px">查询</button>
               			<div id="JS_accountList" class="col-md-12">
						    <label class="box-title">账号信息列表</label>
						    <div class="box-body" >
						        <table class="table table-bordered table-hover">
						            <thead>
						                <tr>
						                    <th class="iCheckbox" width="15"></th>
						                    <th>工号</th>
						                    <th>名称</th>
						                    <th>组织名称</th>
						                    <th>组织编号</th>
						                    <th>手机号码</th>
						                </tr>
						            </thead>
						            <tbody name="content"></tbody>
						        </table>
						    </div>
						    <div class="box-footer no-border">
						        <div class="dataTables_paginate" style="text-align: center;" name="pagination"></div>
						    </div> 
						</div>
                	</div>
                </div>
<!--               	<div class="modal-footer">
	                <div class="text-center">
	                    <button type="reset" class="btn btn-default" id="JS_accountSearchReset" data-dismiss="modal">取消</button>
	                    <button type="button" class="btn btn-primary" id="JS_accountSearchSubmit" name="signin">确认</button>
	                </div>
	            </div> -->
            </form>
        </div>
    </div>
</div>
<!-- 新用户注册 Modal -->
<div class="modal fade" id="JS_signInModal" tabindex="-1" role="dialog" >
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <form id="JS_signInForm">
	            <div class="modal-header">
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	                <h4 class="modal-title">新用户注册</h4>
	            </div>
	            <div class="modal-body">
                	<div class="row">
				        <div class="col-md-6">
				            <div class="form-group input-group-sm">
				                <label>账号<i class="text-red" style="color:red">*</i></label>
				                <input type="text" class="form-control" name="code" required>
				            </div>
				        </div>
				        <div class="col-md-6">
				            <div class="form-group input-group-sm">
				                <label>姓名<i class="text-red" style="color:red">*</i></label>
				                <input type="text" class="form-control" name="name" required>
				            </div>
				        </div>
				    </div>
				    <div class="row">
				        <div class="col-md-6">
				            <div class="form-group input-group-sm">
				                <label>密码<i class="text-red" style="color:red">*</i></label>
				                <input type="password" class="form-control" name="password" required>
				            </div>
				        </div>
				        <div class="col-md-6">
				            <div class="form-group input-group-sm">
				                <label>重复密码<i class="text-red" style="color:red">*</i></label>
				                <input type="password" class="form-control" name="recentPassword" required>
				            </div>
				        </div>
				    </div>
				    <div class="row">
				        <div class="col-md-6">
				            <div class="form-group input-group-sm">
				                <label>手机号码<i class="text-red" style="color:red">*</i></label>
				                <input type="text" class="form-control" name="billId" required>
				            </div>
				        </div>
				        <div class="col-md-6">
				            <div class="form-group input-group-sm">
				                <label>邮箱<i class="text-red" style="color:red">*</i></label>
				                <input type="text" class="form-control" name="email" required>
				            </div>
				        </div>
				    </div>
				    <div class="row">
				        <div class="col-md-6">
				            <div class="form-group input-group-sm">
				                <label>组织<i class="text-red" style="color:red">*</i></label>
						         <select name="organizeId" class="form-control select2 input-sm" data-url="findAllOrg" data-idkey="organizeId" data-namekey="organizeName">
						             <option value="">请选择</option>
						         </select>				            
						    </div>
				        </div>
				    </div>
<!-- 				    <div class="row">
						<div class="form-group col-sm-6">
					        <label for="roleId" >角色<i class="text-red" style="color:red">*</i></label>
					         <select name="roleId" class="form-control select2 input-sm" data-url="getSysRole" data-idkey="roleId" data-namekey="name">
					             <option value="">请选择</option>
					         </select>
					    </div>
				    </div> -->
				    <div class="row">
					    <div class="form-group col-sm-12">	    	
							<label class="control-label fist-text-label check-inline-label">角色选择<span style="color:red">*</span></label>        
							<div class="check-inline">				
						       	<input type="checkbox" name="roleId" value="1"/><label data-toggle="tooltip" title="系统基线申请" style="width:90px;">系统基线申请</label>
								<input style="margin-left:20px;" type="checkbox" name="roleId" value="41"/><label data-toggle="tooltip" title="问题查询" style="width:90px;">问题查询</label>
								<input style="margin-left:20px;" type="checkbox" name="roleId" value="11"/><label data-toggle="tooltip" title="系统基线查询" style="width:90px;">系统基线查询</label>
								<input style="margin-left:20px;" type="checkbox" name="roleId" value="31"/><label data-toggle="tooltip" title="系统指标查询" style="width:90px;">系统指标查询</label>
							</div>
						</div>
				    </div>
	            </div>
	            <div class="modal-footer">
	                <div class="text-center">
	                    <button type="reset" class="btn btn-default" id="JS_addUserinfoReset" data-dismiss="modal">取消</button>
	                    <button type="button" class="btn btn-primary" id="JS_addUserinfoSubmit" name="signin">确认</button>
	                </div>
	            </div>
            </form>
        </div>
    </div>
</div>
<!-- 表格数据  -->
<script id="TPL_accountList" type="text/x-handlebars-template">
{{#each this}}
<tr>
    <td><input type="radio" class="minimal" value="{{applyId}}" name="applyId"></td>
    <td>{{code}}</td>
    <td>{{name}}</td>
	<td>{{organizeName}}</td>	
    <td>{{organizeCode}}</td>
    <td>{{billId}}</td>
</tr>
{{/each}}
</script>
<script src="lib/jquery/2.2.3/jquery.min.js"></script>
<script src="lib/xsm-msgbox/0.2.0/js/xsm-msgbox.min.js"></script>
<script src="lib/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="lib/rose/1.0.0/Rose.src.js"></script>
<!--[if lt IE 9]>
  <script src="http://apps.bdimg.com/libs/html5shiv/3.7/html5shiv.min.js"></script>
  <script src="http://apps.bdimg.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <script src="lib/jquery/1.11.3/jquery.js"></script>
<![endif]-->
<!-- <script type="text/javascript">
    $(function() {
            $('#login #password').focus(function() {
                $('#owl-login').addClass('password');
            }).blur(function() {
                $('#owl-login').removeClass('password');
            });
            $("body").keydown(function() {
                if (event.keyCode == "13") {//keyCode=13是回车键
                    $("#mysubmit").click();
                }
            });
            $("#mysubmit").click(function() {
                XMS.msgbox.show('正在登录中，请稍候...', 'loading');

                var data = {
                    username: $("#myform").find("input[name='username']").val(),
                    password: $("#myform").find("input[name='password']").val()
                }

                if($.trim(data.username)==''){
                    window.XMS.msgbox.show('亲，用户名不能为空！', 'error', 2000);
                    return false;
                }
                if($.trim(data.password)==''){
                    window.XMS.msgbox.show('亲，密码不能为空！', 'error', 2000);
                    return false;
                }

                // 待删除，用于测试前台跳转效果
                if(window.location.href.indexOf("8888")>=0){
                   setTimeout(function(){
                        window.location = "index.html";
                    },1500)
                }
                $.post("../login", data, function(d) {
                    if (d) {
                        var status = d["retCode"];
                        if (status == "200") {
                            window.location = "index.html";
                        } else {
                            window.XMS.msgbox.show(d["retMessage"], 'error', 2000);
                            //$("#tips-error").html(d["retMessage"]);
                        }
                    }
                });
                return false;
            });
            //改密function
            $("#JS_changePassword").bind("click",function(){
            var _modal = $("#JS_changePasswordModal");
            var _form = $("#JS_changePasswordForm");
			Utils.setSelectData(_form);
            $("#JS_changePasswordModal").modal('show');
			
            _modal.find("[name='submit']").click(function(){
                if($.trim(_form.find("input[name='code']").val())=='' || $.trim(_form.find("input[name='password']").val())==''){
                    XMS.msgbox.show('亲，用户名和原密码不能为空！', 'error', 2000);
                    return false;
                }
                if($.trim(_form.find("input[name='newPassword']").val())=='' || $.trim(_form.find("input[name='recentnewPassword']").val())==''){
                    XMS.msgbox.show('亲，新密码和重复密码不能为空！', 'error', 2000);
                    return false;
                }
                if(!Rose.validate.Check('passwrd',_form.find("input[name='newPassword']").val())){
                    XMS.msgbox.show('亲，密码长度在6-10位之间，包含大写字母、小写字母及数字！', 'error', 2000);
                    return false;
                }
                if(_form.find("input[name='newPassword']").val()!=_form.find("input[name='recentnewPassword']").val()){
                    XMS.msgbox.show('亲，请确认两次密码输入一致！', 'error', 2000);
                    return false;
                }
                XMS.msgbox.show('密码修改中，请稍候...', 'loading');
                var data = {
                    code: $.trim(_form.find("input[name='code']").val()),
                    password: $.trim(_form.find("input[name='password']").val()),
                    newPassword: $.trim(_form.find("input[name='newPassword']").val())
                }
                $.post("/aiga3/aiga/staff/changeMyPass", data, function(d) {
	                if (d) {
	                    var status = d["retCode"];
	                    if (status == "200") {
	                        XMS.msgbox.show('密码修改成功', 'success', 2000);
	                        setTimeout(function(){
	                            _modal.modal('hide');
	                        },1500)
	                    } else {
	                        window.XMS.msgbox.show(d["retMessage"], 'error', 2000);
	                        //$("#tips-error").html(d["retMessage"]);
	                    }
	                }
            	});
            })
        })
        //注册function
        // 添加员工
        $("#JS_signIn").bind("click",function(){
            var _modal = $("#JS_signInModal");
            var _form = $("#JS_signInForm");
            _modal.modal('show');
			var cmd = _form.serialize();

            _modal.find("[name='signin']").click(function(){
                if($.trim(_form.find("input[name='code']").val())=='' || $.trim(_form.find("input[name='password']").val())==''){
                    XMS.msgbox.show('亲，用户名和原密码不能为空！', 'error', 2000);
                    return false;
                }
                if($.trim(_form.find("input[name='password']").val())=='' || $.trim(_form.find("input[name='recentPassword']").val())==''){
                    XMS.msgbox.show('亲，新密码和重复密码不能为空！', 'error', 2000);
                    return false;
                }
                if(!Rose.validate.Check('passwrd',_form.find("input[name='password']").val())){
                    XMS.msgbox.show('亲，密码长度在6-10位之间，包含大写字母、小写字母及数字！', 'error', 2000);
                    return false;
                }
                if(_form.find("input[name='password']").val()!=_form.find("input[name='recentPassword']").val()){
                    XMS.msgbox.show('亲，请确认两次密码输入一致！', 'error', 2000);
                    return false;
                }
				
			  	XMS.msgbox.show('数据加载中，请稍候...', 'loading')
                Rose.ajax.postJson("/aiga3/aiga/staff/saveSignIn", cmd, function(json, status) {
					if(status) {
						// 添加用户成功后，刷新用户列表页
						XMS.msgbox.show('保存成功！', 'success', 2000)
						// 关闭弹出层
						$(Dom.addUserinfoModal).modal('hide');
					} else {
						XMS.msgbox.show(json.retMessage, 'error', 2000);
					}
	  			});
                
            })
        })
    });
    </script> -->
    <script src="lib/jquery/2.2.3/jquery.min.js"></script>
    <script src="lib/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="lib/fakeLoader/fakeLoader.js"></script>
    <script src="lib/seajs/sea.js"></script>
    <script src="lib/seajs/sea-plugins.js"></script>
    <script src="conf/config.js"></script>
<script>
seajs.use("script/login", function(Query) {
    Query.init();
});
</script>
</body>
</html>
